group_by(sentence_id) %>%
mutate(sent = paste(token, collapse = ""),
sent_index = row_number()) %>%
ungroup() %>%
mutate(segment = if_else((!str_detect(token, "^ ") & (sent_index != 1)), T, F),
token = str_replace(token, " ", "")) %>%
mutate(is_seg_1 = lead(segment),
seg_1 = lead(token),
surp_1 = lead(GPT3))
gpt3 = read.csv("../data/model_output/gpt3_output.txt", sep="\t") %>%
mutate(logprob = if_else( (!is.na(sentence_id) & is.na(logprob)), 0, logprob)) %>%
filter(token != ".") %>%
drop_na() %>%
group_by(sentence_id) %>%
mutate(sent = paste(token, collapse = ""),
sent_index = row_number()) %>%
ungroup() %>%
mutate(segment = if_else((!str_detect(token, "^ ") & (sent_index != 1)), T, F),
token = str_replace(token, " ", ""))
gpt3 = read.csv("../data/model_output/gpt3_output.txt", sep="\t") %>%
mutate(logprob = if_else( (!is.na(sentence_id) & is.na(logprob)), 0, logprob)) %>%
filter(token != ".") %>%
drop_na() %>%
group_by(sentence_id) %>%
mutate(sent = paste(token, collapse = ""),
sent_index = row_number()) %>%
ungroup() %>%
mutate(segment = if_else((!str_detect(token, "^ ") & (sent_index != 1)), T, F),
token = str_replace(token, " ", "")) %>%
mutate(is_seg_1 = lead(segment),
seg_1 = lead(token),
surp_1 = lead(logprob))
gpt3
gpt3 = read.csv("../data/model_output/gpt3_output.txt", sep="\t") %>%
mutate(logprob = if_else( (!is.na(sentence_id) & is.na(logprob)), 0, logprob)) %>%
filter(token != ".") %>%
drop_na() %>%
group_by(sentence_id) %>%
mutate(sent = paste(token, collapse = ""),
sent_index = row_number()) %>%
ungroup() %>%
mutate(segment = if_else((!str_detect(token, "^ ") & (sent_index != 1)), T, F),
token = str_replace(token, " ", "")) %>%
mutate(is_seg_1 = lead(segment),
seg_1 = lead(token),
surp_1 = lead(logprob),
is_seg_2 = lead(is_seg_1),
seg_2 = lead(seg_1),
surp_2 = lead(surp_1))
gpt3
gpt3 = read.csv("../data/model_output/gpt3_output.txt", sep="\t") %>%
mutate(logprob = if_else( (!is.na(sentence_id) & is.na(logprob)), 0, logprob)) %>%
filter(token != ".") %>%
drop_na() %>%
group_by(sentence_id) %>%
mutate(sent = paste(token, collapse = ""),
sent_index = row_number()) %>%
ungroup() %>%
mutate(segment = if_else((!str_detect(token, "^ ") & (sent_index != 1)), T, F),
token = str_replace(token, " ", "")) %>%
mutate(is_seg_1 = lead(segment),
seg_1 = lead(token),
surp_1 = lead(logprob),
is_seg_2 = lead(is_seg_1),
seg_2 = lead(seg_1),
surp_2 = lead(surp_1)) %>%
mutate(
logprop = if_else(is_seg_1, logprob + surp_1, logprob),
token = if_else(is_seg_1, paste(token, seg_1, sep=""), token),
logprop = if_else(is_seg_2, logprob + surp_2, logprob),
token = if_else(is_seg_2, paste(token, seg_2, sep=""), token)
)
gpt3
gpt3 = read.csv("../data/model_output/gpt3_output.txt", sep="\t") %>%
mutate(logprob = if_else( (!is.na(sentence_id) & is.na(logprob)), 0, logprob)) %>%
filter(token != ".") %>%
drop_na() %>%
group_by(sentence_id) %>%
mutate(sent = paste(token, collapse = ""),
sent_index = row_number()) %>%
ungroup() %>%
mutate(segment = if_else((!str_detect(token, "^ ") & (sent_index != 1)), T, F),
token = str_replace(token, " ", "")) %>%
mutate(is_seg_1 = lead(segment),
seg_1 = lead(token),
surp_1 = lead(logprob),
is_seg_2 = lead(is_seg_1),
seg_2 = lead(seg_1),
surp_2 = lead(surp_1)) %>%
mutate(
logprop = if_else(is_seg_1, logprob + surp_1, logprob),
token = if_else(is_seg_1, paste(token, seg_1, sep=""), token),
logprop = if_else(is_seg_2, logprob + surp_2, logprob),
token = if_else(is_seg_2, paste(token, seg_2, sep=""), token)
) %>%
select(-segment, -is_seg_1, -seg_1, -surp_1, -is_seg_2, -surp_2) %>%
mutate(logprob = logprob * -1,) %>%
rename(GPT3 = logprob, GPT3_token = token)
gpt3 %>%
filter(segment == T)
gpt3
gpt3 = read.csv("../data/model_output/gpt3_output.txt", sep="\t") %>%
mutate(logprob = if_else( (!is.na(sentence_id) & is.na(logprob)), 0, logprob)) %>%
filter(token != ".") %>%
drop_na() %>%
group_by(sentence_id) %>%
mutate(sent = paste(token, collapse = ""),
sent_index = row_number()) %>%
ungroup() %>%
mutate(segment = if_else((!str_detect(token, "^ ") & (sent_index != 1)), T, F),
token = str_replace(token, " ", "")) %>%
mutate(is_seg_1 = lead(segment),
seg_1 = lead(token),
surp_1 = lead(logprob),
is_seg_2 = lead(is_seg_1),
seg_2 = lead(seg_1),
surp_2 = lead(surp_1)) %>%
mutate(
logprob = if_else(is_seg_1, logprob + surp_1, logprob),
token = if_else(is_seg_1, paste(token, seg_1, sep=""), token),
logprob = if_else(is_seg_2, logprob + surp_2, logprob),
token = if_else(is_seg_2, paste(token, seg_2, sep=""), token)
) %>%
select(-segment, -is_seg_1, -seg_1, -surp_1, -is_seg_2, -surp_2) %>%
mutate(logprob = logprob * -1,) %>%
rename(GPT3 = logprob, GPT3_token = token)
gpt3 = read.csv("../data/model_output/gpt3_output.txt", sep="\t") %>%
mutate(logprob = if_else( (!is.na(sentence_id) & is.na(logprob)), 0, logprob)) %>%
filter(token != ".") %>%
drop_na() %>%
group_by(sentence_id) %>%
mutate(sent = paste(token, collapse = ""),
sent_index = row_number()) %>%
ungroup() %>%
mutate(segment = if_else((!str_detect(token, "^ ") & (sent_index != 1)), T, F),
token = str_replace(token, " ", "")) %>%
mutate(is_seg_1 = lead(segment),
seg_1 = lead(token),
surp_1 = lead(logprob),
is_seg_2 = lead(is_seg_1),
seg_2 = lead(seg_1),
surp_2 = lead(surp_1)) %>%
mutate(
logprob = if_else(is_seg_1, logprob + surp_1, logprob),
token = if_else(is_seg_1, paste(token, seg_1, sep=""), token),
logprob = if_else(is_seg_2, logprob + surp_2, logprob),
token = if_else(is_seg_2, paste(token, seg_2, sep=""), token)
) %>%
select(-segment, -is_seg_1, -seg_1, -surp_1, -is_seg_2, -surp_2) %>%
mutate(logprob = logprob * -1,) %>%
rename(GPT3 = logprob, GPT3_token = token)
gpt3
gpt3 = read.csv("../data/model_output/gpt3_output.txt", sep="\t") %>%
mutate(logprob = if_else( (!is.na(sentence_id) & is.na(logprob)), 0, logprob)) %>%
filter(token != ".") %>%
drop_na() %>%
group_by(sentence_id) %>%
mutate(sent = paste(token, collapse = ""),
sent_index = row_number()) %>%
ungroup() %>%
mutate(segment = if_else((!str_detect(token, "^ ") & (sent_index != 1)), T, F),
token = str_replace(token, " ", "")) %>%
mutate(is_seg_1 = lead(segment),
seg_1 = lead(token),
surp_1 = lead(logprob),
is_seg_2 = lead(is_seg_1),
seg_2 = lead(seg_1),
surp_2 = lead(surp_1)) %>%
mutate(
logprob = if_else(is_seg_1, logprob + surp_1, logprob),
token = if_else(is_seg_1, paste(token, seg_1, sep=""), token),
logprob = if_else(is_seg_2, logprob + surp_2, logprob),
token = if_else(is_seg_2, paste(token, seg_2, sep=""), token)
) %>%
select(-segment, -is_seg_1, -seg_1, -surp_1, -is_seg_2, -surp_2, -seg_2) %>%
mutate(logprob = logprob * -1,) %>%
rename(GPT3 = logprob, GPT3_token = token)
gpt3
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3))
df_base = read.csv("../data/combined_results.csv") %>%
select(-X) %>%
group_by(test, condition, item) %>%
mutate(sent = paste(token, collapse = " "),
sent_index = row_number()) %>%
ungroup()
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3))
df_gpt3 = df %>% filter(GPT3 != 0)
print(nrow(df_gpt3))
print(nrow(df))
df
df
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent)
df %>%
gather(model, surprisal, 7:11) %>%
group_by(condition, test) %>%
summarise()
df
df = read.csv("../data/combined_results.csv") %>%
select(-X)
df
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent)
df %>%
gather(model, surprisal, 7:11) %>%
group_by(test, model) %>%
summarise(m=mean(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat=identiy) +
facet_grid(~test)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent)
df %>%
gather(model, surprisal, 7:11) %>%
group_by(test, model) %>%
summarise(m=mean(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identiy") +
facet_grid(~test)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent)
df %>%
gather(model, surprisal, 7:11) %>%
group_by(test, model) %>%
summarise(m=mean(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~test)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent)
df %>%
gather(model, surprisal, 7:11) %>%
group_by(test, model) %>%
summarise(m=mean(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(test~)
df %>%
gather(model, surprisal, 7:11)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent)
df %>%
gather(model, surprisal, 6:11) %>%
group_by(test, model) %>%
summarise(m=mean(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(test~.)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent)
df %>%
gather(model, surprisal, 6:11) %>%
group_by(test, model) %>%
summarise(m=mean(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=model, y=m)) +
geom_bar(stat="identity") +
facet_grid(test~.)
df %>%
gather(model, surprisal, 6:11) %>%
group_by(test, model) %>%
summarise(m=mean(surprisal)) %>%
ungroup()
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent)
df %>%
gather(model, surprisal, 6:11) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=model, y=m)) +
geom_bar(stat="identity") +
facet_grid(test~.)
df %>%
gather(model, surprisal, 6:11)
df %>%
gather(model, surprisal, 6:11) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=model, y=m)) +
geom_bar(stat="identity") +
facet_grid(test~.)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent)
df %>%
gather(model, surprisal, 6:11) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~model)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent)
df %>%
gather(model, surprisal, 6:10) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~model)
df
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent, GPT3_token)
df %>%
gather(model, surprisal, 6:10) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~model)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent, -GPT3_token)
df %>%
gather(model, surprisal, 6:10) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~model)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent, -GPT3_token)
df %>%
gather(model, surprisal, 6:10) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~model) +
theme(axis.text.x = element_text(angle = 15, hjust=1))
ggsave("./images/data_check.png", width = 10, height = 5)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent, -GPT3_token)
df %>%
gather(model, surprisal, 6:10) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~model) +
theme(axis.text.x = element_text(size= 10, angle = 15, hjust=1))
ggsave("./images/data_check.png", width = 20, height = 10)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent, -GPT3_token)
df %>%
gather(model, surprisal, 6:10) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~model) +
theme(axis.text.x = element_text(size= 10, angle = 90, hjust=1))
ggsave("./images/data_check.png", width = 20, height = 10)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent, -GPT3_token)
df %>%
gather(model, surprisal, 6:10) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~model) +
theme(axis.text.x = element_text(size= 10, angle = 90, hjust=0.5))
ggsave("./images/data_check.png", width = 20, height = 10)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent, -GPT3_token)
df %>%
gather(model, surprisal, 6:10) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=sum(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~model) +
theme(axis.text.x = element_text(size= 10, angle = 90, hjust=1, vjust=0.5))
ggsave("./images/data_check.png", width = 20, height = 10)
df = merge(df_base, gpt3, by=c("sent", "sent_index"), all=T) %>%
mutate(token = as.character(token),
GPT3_token = as.character(GPT3_token)) %>%
mutate(GPT3 = if_else(token != GPT3_token, 0, GPT3)) %>%
select(-sent_index, -sentence_id) %>%
mutate(GPT3 = if_else(is.na(GPT3), 0, GPT3)) %>%
select(-sent, -GPT3_token)
df %>%
gather(model, surprisal, 6:10) %>%
mutate(surprisal = as.numeric(surprisal)) %>%
group_by(test, model) %>%
summarise(m=mean(surprisal)) %>%
ungroup() %>%
ggplot(aes(x=test, y=m)) +
geom_bar(stat="identity") +
facet_grid(~model) +
theme(axis.text.x = element_text(size= 10, angle = 90, hjust=1, vjust=0.5))
ggsave("./images/data_check.png", width = 20, height = 10)
